<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicios: Direcciones IP (IPv4)</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #004085;
            font-size: 2.8em;
            margin-bottom: 30px;
            border-bottom: 3px solid #007bff;
            padding-bottom: 15px;
        }
        h2 {
            color: #0056b3;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e7ee;
            padding-bottom: 10px;
        }
        h3 {
            color: #007bff;
            font-size: 1.3em;
            margin-top: 25px;
            margin-bottom: 10px;
        }
        .question-block {
            background-color: #e9f7fe;
            border: 1px solid #cceeff;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .question-block p {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }
        .options label {
            display: block;
            margin-bottom: 8px;
            cursor: pointer;
            padding: 5px 0;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .options label:hover {
            background-color: #e0f2f7;
        }
        .options input[type="radio"],
        .options input[type="checkbox"] {
            margin-right: 10px;
        }
        select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            background-color: #fcfcfc;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        .feedback {
            margin-top: 10px;
            padding: 8px 12px;
            border-radius: 5px;
            font-weight: 600;
            display: none; /* Hidden by default */
        }
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .button-group {
            text-align: center;
            margin-top: 40px;
        }
        .btn {
            background-color: #007bff;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
        }
        .btn:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }
        .results-summary {
            margin-top: 50px;
            padding: 30px;
            background-color: #f0fdf4;
            border: 2px solid #28a745;
            border-radius: 12px;
            display: none; /* Hidden by default */
        }
        .results-summary h2 {
            color: #28a745;
            border-bottom-color: #28a745;
        }
        .results-summary p {
            font-size: 1.1em;
            margin-bottom: 10px;
        }
        .results-summary input[type="text"] {
            width: calc(50% - 10px);
            padding: 10px;
            margin-right: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
        }
        .results-summary .btn {
            margin-top: 20px;
            width: auto;
            padding: 12px 25px;
            font-size: 1em;
            background-color: #6c757d;
            box-shadow: 0 4px 10px rgba(108, 117, 125, 0.3);
        }
        .results-summary .btn:hover {
            background-color: #5a6268;
        }
        .score-per-question {
            margin-top: 20px;
            border-top: 1px dashed #ccc;
            padding-top: 15px;
        }
        .score-per-question div {
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        .score-per-question .correct-q {
            color: #155724;
            font-weight: 600;
        }
        .score-per-question .incorrect-q {
            color: #721c24;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ejercicios: Direcciones IP (IPv4)</h1>
        <p style="text-align: center; margin-bottom: 30px;">Pon a prueba tus conocimientos sobre la estructura y clasificación de las direcciones IPv4.</p>

        <!-- Sección 1: Clasificación de Direcciones IP -->
        <h2>1. Clasificación de Direcciones IP</h2>
        <p>Para cada dirección IP, selecciona su Clase y si es Pública, Privada o Reservada.</p>

        <div class="question-block" id="q1-ip">
            <h3>IP: <code>192.168.0.1</code></h3>
            <p>Clase:</p>
            <select id="q1-class">
                <option value="">Selecciona</option>
                <option value="A">Clase A</option>
                <option value="D">Clase D</option>
                <option value="C">Clase C</option>
                <option value="B">Clase B</option>
            </select>
            <p>Tipo:</p>
            <select id="q1-type">
                <option value="">Selecciona</option>
                <option value="Pública">Pública</option>
                <option value="Reservada">Reservada</option>
                <option value="Privada">Privada</option>
            </select>
            <div class="feedback" id="q1-feedback"></div>
        </div>

        <div class="question-block" id="q2-ip">
            <h3>IP: <code>10.5.10.100</code></h3>
            <p>Clase:</p>
            <select id="q2-class">
                <option value="">Selecciona</option>
                <option value="B">Clase B</option>
                <option value="A">Clase A</option>
                <option value="C">Clase C</option>
                <option value="D">Clase D</option>
            </select>
            <p>Tipo:</p>
            <select id="q2-type">
                <option value="">Selecciona</option>
                <option value="Reservada">Reservada</option>
                <option value="Pública">Pública</option>
                <option value="Privada">Privada</option>
            </select>
            <div class="feedback" id="q2-feedback"></div>
        </div>

        <div class="question-block" id="q3-ip">
            <h3>IP: <code>172.20.0.50</code></h3>
            <p>Clase:</p>
            <select id="q3-class">
                <option value="">Selecciona</option>
                <option value="C">Clase C</option>
                <option value="B">Clase B</option>
                <option value="A">Clase A</option>
                <option value="D">Clase D</option>
            </select>
            <p>Tipo:</p>
            <select id="q3-type">
                <option value="">Selecciona</option>
                <option value="Pública">Pública</option>
                <option value="Privada">Privada</option>
                <option value="Reservada">Reservada</option>
            </select>
            <div class="feedback" id="q3-feedback"></div>
        </div>

        <div class="question-block" id="q4-ip">
            <h3>IP: <code>130.1.2.3</code></h3>
            <p>Clase:</p>
            <select id="q4-class">
                <option value="">Selecciona</option>
                <option value="A">Clase A</option>
                <option value="B">Clase B</option>
                <option value="D">Clase D</option>
                <option value="C">Clase C</option>
            </select>
            <p>Tipo:</p>
            <select id="q4-type">
                <option value="">Selecciona</option>
                <option value="Privada">Privada</option>
                <option value="Pública">Pública</option>
                <option value="Reservada">Reservada</option>
            </select>
            <div class="feedback" id="q4-feedback"></div>
        </div>

        <div class="question-block" id="q5-ip">
            <h3>IP: <code>200.200.200.200</code></h3>
            <p>Clase:</p>
            <select id="q5-class">
                <option value="">Selecciona</option>
                <option value="B">Clase B</option>
                <option value="C">Clase C</option>
                <option value="A">Clase A</option>
                <option value="D">Clase D</option>
            </select>
            <p>Tipo:</p>
            <select id="q5-type">
                <option value="">Selecciona</option>
                <option value="Reservada">Reservada</option>
                <option value="Privada">Privada</option>
                <option value="Pública">Pública</option>
            </select>
            <div class="feedback" id="q5-feedback"></div>
        </div>

        <div class="question-block" id="q6-ip">
            <h3>IP: <code>172.32.1.1</code></h3>
            <p>Clase:</p>
            <select id="q6-class">
                <option value="">Selecciona</option>
                <option value="A">Clase A</option>
                <option value="D">Clase D</option>
                <option value="B">Clase B</option>
                <option value="C">Clase C</option>
            </select>
            <p>Tipo:</p>
            <select id="q6-type">
                <option value="">Selecciona</option>
                <option value="Privada">Privada</option>
                <option value="Reservada">Reservada</option>
                <option value="Pública">Pública</option>
            </select>
            <div class="feedback" id="q6-feedback"></div>
        </div>

        <div class="question-block" id="q7-ip">
            <h3>IP: <code>127.0.0.1</code></h3>
            <p>Clase:</p>
            <select id="q7-class">
                <option value="">Selecciona</option>
                <option value="B">Clase B</option>
                <option value="C">Clase C</option>
                <option value="A">Clase A</option>
                <option value="D">Clase D</option>
            </select>
            <p>Tipo:</p>
            <select id="q7-type">
                <option value="">Selecciona</option>
                <option value="Pública">Pública</option>
                <option value="Privada">Privada</option>
                <option value="Reservada">Reservada</option>
            </select>
            <div class="feedback" id="q7-feedback"></div>
        </div>

        <div class="question-block" id="q8-ip">
            <h3>IP: <code>224.0.0.1</code></h3>
            <p>Clase:</p>
            <select id="q8-class">
                <option value="">Selecciona</option>
                <option value="A">Clase A</option>
                <option value="B">Clase B</option>
                <option value="D">Clase D</option>
                <option value="C">Clase C</option>
            </select>
            <p>Tipo:</p>
            <select id="q8-type">
                <option value="">Selecciona</option>
                <option value="Pública">Pública</option>
                <option value="Privada">Privada</option>
                <option value="Reservada">Reservada</option>
            </select>
            <div class="feedback" id="q8-feedback"></div>
        </div>

        <div class="question-block" id="q9-ip">
            <h3>IP: <code>1.1.1.1</code></h3>
            <p>Clase:</p>
            <select id="q9-class">
                <option value="">Selecciona</option>
                <option value="D">Clase D</option>
                <option value="A">Clase A</option>
                <option value="B">Clase B</option>
                <option value="C">Clase C</option>
            </select>
            <p>Tipo:</p>
            <select id="q9-type">
                <option value="">Selecciona</option>
                <option value="Reservada">Reservada</option>
                <option value="Pública">Pública</option>
                <option value="Privada">Privada</option>
            </select>
            <div class="feedback" id="q9-feedback"></div>
        </div>

        <div class="question-block" id="q10-ip">
            <h3>IP: <code>192.167.255.255</code></h3>
            <p>Clase:</p>
            <select id="q10-class">
                <option value="">Selecciona</option>
                <option value="A">Clase A</option>
                <option value="C">Clase C</option>
                <option value="B">Clase B</option>
                <option value="D">Clase D</option>
            </select>
            <p>Tipo:</p>
            <select id="q10-type">
                <option value="">Selecciona</option>
                <option value="Reservada">Reservada</option>
                <option value="Privada">Privada</option>
                <option value="Pública">Pública</option>
            </select>
            <div class="feedback" id="q10-feedback"></div>
        </div>

        <!-- Sección 2: Preguntas de Selección Múltiple -->
        <h2>2. Preguntas de Selección Múltiple</h2>

        <div class="question-block" id="q11-mc-block"> <!-- Added -block to ID -->
            <p>¿Cuál de los siguientes protocolos es orientado a conexión y garantiza la entrega de datos?</p>
            <div class="options">
                <label><input type="radio" name="q11" value="IP"> IP</label>
                <label><input type="radio" name="q11" value="TCP"> TCP</label>
                <label><input type="radio" name="q11" value="UDP"> UDP</label>
                <label><input type="radio" name="q11" value="ICMP"> ICMP</label>
            </div>
            <div class="feedback" id="q11-feedback"></div>
        </div>

        <div class="question-block" id="q12-mc-block"> <!-- Added -block to ID -->
            <p>¿Qué tipo de red conecta dispositivos en un área geográfica limitada como una oficina o un campus?</p>
            <div class="options">
                <label><input type="radio" name="q12" value="MAN"> MAN</label>
                <label><input type="radio" name="q12" value="LAN"> LAN</label>
                <label><input type="radio" name="q12" value="WAN"> WAN</label>
                <label><input type="radio" name="q12" value="PAN"> PAN</label>
            </div>
            <div class="feedback" id="q12-feedback"></div>
        </div>

        <!-- Sección 3: Preguntas de Verdadero/Falso -->
        <h2>3. Preguntas de Verdadero/Falso</h2>

        <div class="question-block" id="q13-tf-block"> <!-- Added -block to ID -->
            <p>El modelo OSI tiene 5 capas.</p>
            <div class="options">
                <label><input type="radio" name="q13" value="Falso"> Falso</label>
                <label><input type="radio" name="q13" value="Verdadero"> Verdadero</label>
            </div>
            <div class="feedback" id="q13-feedback"></div>
        </div>

        <div class="question-block" id="q14-tf-block"> <!-- Added -block to ID -->
            <p>La fibra óptica es inmune a las interferencias electromagnéticas.</p>
            <div class="options">
                <label><input type="radio" name="q14" value="Falso"> Falso</label>
                <label><input type="radio" name="q14" value="Verdadero"> Verdadero</label>
            </div>
            <div class="feedback" id="q14-feedback"></div>
        </div>

        <div class="button-group">
            <button class="btn" onclick="evaluateAnswers()">EVALUAR RESPUESTAS</button>
        </div>

        <!-- Resumen de Resultados -->
        <div class="results-summary" id="resultsSummary">
            <h2>Resumen de Resultados</h2>
            <p><strong>Puntaje Total:</strong> <span id="totalScore">0</span> / 14</p>
            <div class="score-per-question" id="scorePerQuestion">
                <!-- Scores for each question will be inserted here by JS -->
            </div>
            
            <h3>Generar Resumen en PDF</h3>
            <p>Completa tus datos para descargar el resumen de tus resultados.</p>
            <input type="text" id="studentName" placeholder="Nombre">
            <input type="text" id="studentSurname" placeholder="Apellido">
            <button class="btn" onclick="generatePdfSummary()">Descargar Resumen</button>
        </div>
    </div>

    <!-- jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Define las respuestas correctas
        const correctAnswers = {
            // IP Classification
            "q1-class": "C", "q1-type": "Privada",
            "q2-class": "A", "q2-type": "Privada",
            "q3-class": "B", "q3-type": "Privada",
            "q4-class": "B", "q4-type": "Pública",
            "q5-class": "C", "q5-type": "Pública",
            "q6-class": "B", "q6-type": "Pública", // 172.32.x.x is outside 172.16-31 private range
            "q7-class": "A", "q7-type": "Reservada",
            "q8-class": "D", "q8-type": "Reservada",
            "q9-class": "A", "q9-type": "Pública",
            "q10-class": "C", "q10-type": "Pública",

            // Multiple Choice
            "q11": "TCP",
            "q12": "LAN",

            // True/False
            "q13": "Falso", // OSI has 7 layers
            "q14": "Verdadero"
        };

        // Almacena los resultados por pregunta para el PDF
        let questionResults = {};

        function evaluateAnswers() {
            let totalCorrect = 0;
            questionResults = {}; // Reset results for new evaluation
            let allAnswered = true; // Flag to check if all questions are answered

            // Function to evaluate a single input (select or radio)
            // inputId: For select, it's the element's ID. For radio, it's the name attribute.
            // parentBlockId: The ID of the .question-block div containing this input.
            function evaluateSingleInput(inputId, correctValue, questionText, inputType, parentBlockId) {
                let userAnswer = "";
                let isCorrect = false;
                
                if (inputType === 'select') {
                    const selectElement = document.getElementById(inputId);
                    if (selectElement) {
                        userAnswer = selectElement.value;
                        isCorrect = (userAnswer === correctValue);
                        if (userAnswer === "") { // Check if select is unanswered
                            allAnswered = false;
                        }
                    } else {
                        console.error(`Elemento SELECT con ID ${inputId} no encontrado.`);
                    }
                } else if (inputType === 'radio') {
                    const selectedOption = document.querySelector(`input[name="${inputId}"]:checked`);
                    if (selectedOption) {
                        userAnswer = selectedOption.value;
                        isCorrect = (userAnswer === correctValue);
                    } else {
                        // If no option is selected, mark as unanswered
                        allAnswered = false;
                    }
                } else {
                    console.error(`Tipo de entrada desconocido: ${inputType}`);
                }
                
                return { isCorrect, userAnswer: userAnswer || 'No respondido', correctAnswer: correctValue, text: questionText };
            }

            // --- Evaluate IP Classification questions ---
            const ipQuestionsData = [
                { id: "q1", ip: "192.168.0.1" }, { id: "q2", ip: "10.5.10.100" },
                { id: "q3", ip: "172.20.0.50" }, { id: "q4", ip: "130.1.2.3" },
                { id: "q5", ip: "200.200.200.200" }, { id: "q6", ip: "172.32.1.1" },
                { id: "q7", ip: "127.0.0.1" }, { id: "q8", ip: "224.0.0.1" },
                { id: "q9", ip: "1.1.1.1" }, { id: "q10", ip: "192.167.255.255" }
            ];

            ipQuestionsData.forEach(q => {
                const classResult = evaluateSingleInput(`${q.id}-class`, correctAnswers[`${q.id}-class`], `IP ${q.ip} - Clase`, 'select', `${q.id}-ip`);
                const typeResult = evaluateSingleInput(`${q.id}-type`, correctAnswers[`${q.id}-type`], `IP ${q.ip} - Tipo`, 'select', `${q.id}-ip`);

                // Only update feedback if allAnswered is still true (no previous unanswered questions)
                if (allAnswered) {
                    const blockFeedbackDiv = document.getElementById(`${q.id}-ip`).querySelector('.feedback');
                    if (blockFeedbackDiv) {
                        blockFeedbackDiv.style.display = 'block';
                        if (classResult.isCorrect && typeResult.isCorrect) {
                            blockFeedbackDiv.className = 'feedback correct';
                            blockFeedbackDiv.textContent = '¡Correcto!';
                            totalCorrect += 2; // Each part is a point
                        } else {
                            blockFeedbackDiv.className = 'feedback incorrect';
                            blockFeedbackDiv.textContent = `Incorrecto. Clase: ${classResult.isCorrect ? 'Correcto' : 'Incorrecto'}. Tipo: ${typeResult.isCorrect ? 'Correcto' : 'Incorrecto'}.`;
                        }
                    } else {
                        console.error(`Div de feedback para ${q.id}-ip no encontrado.`);
                    }
                }

                questionResults[`${q.id}-class`] = classResult;
                questionResults[`${q.id}-type`] = typeResult;
            });

            // --- Evaluate Multiple Choice questions ---
            const mcQuestionsData = [
                { id: "q11", text: "¿Cuál de los siguientes protocolos es orientado a conexión y garantiza la entrega de datos?", blockId: "q11-mc-block" },
                { id: "q12", text: "¿Qué tipo de red conecta dispositivos en un área geográfica limitada como una oficina o un campus?", blockId: "q12-mc-block" }
            ];

            mcQuestionsData.forEach(q => {
                const result = evaluateSingleInput(q.id, correctAnswers[q.id], q.text, 'radio', q.blockId);
                
                if (allAnswered) { // Only update feedback if allAnswered is still true
                    const feedbackDiv = document.getElementById(q.blockId).querySelector('.feedback');
                    if (feedbackDiv) {
                        feedbackDiv.style.display = 'block';
                        if (result.isCorrect) {
                            feedbackDiv.className = 'feedback correct';
                            feedbackDiv.textContent = '¡Correcto!';
                            totalCorrect++;
                        } else {
                            feedbackDiv.className = 'feedback incorrect';
                            feedbackDiv.textContent = `Incorrecto. La respuesta correcta era: ${result.correctAnswer}`;
                        }
                    } else {
                        console.error(`Div de feedback para ${q.blockId} no encontrado.`);
                    }
                }
                questionResults[q.id] = result;
            });

            // --- Evaluate True/False questions ---
            const tfQuestionsData = [
                { id: "q13", text: "El modelo OSI tiene 5 capas.", blockId: "q13-tf-block" },
                { id: "q14", text: "La fibra óptica es inmune a las interferencias electromagnéticas.", blockId: "q14-tf-block" }
            ];

            tfQuestionsData.forEach(q => {
                const result = evaluateSingleInput(q.id, correctAnswers[q.id], q.text, 'radio', q.blockId);
                
                if (allAnswered) { // Only update feedback if allAnswered is still true
                    const feedbackDiv = document.getElementById(q.blockId).querySelector('.feedback');
                    if (feedbackDiv) {
                        feedbackDiv.style.display = 'block';
                        if (result.isCorrect) {
                            feedbackDiv.className = 'feedback correct';
                            feedbackDiv.textContent = '¡Correcto!';
                            totalCorrect++;
                        } else {
                            feedbackDiv.className = 'feedback incorrect';
                            feedbackDiv.textContent = `Incorrecto. La respuesta correcta era: ${result.correctAnswer}`;
                        }
                    } else {
                        console.error(`Div de feedback para ${q.blockId} no encontrado.`);
                    }
                }
                questionResults[q.id] = result;
            });

            // --- Final check and display results ---
            if (!allAnswered) {
                alert('Por favor, responde todas las preguntas antes de evaluar.');
                // Hide feedback and summary if not all questions are answered
                document.querySelectorAll('.feedback').forEach(div => div.style.display = 'none');
                document.getElementById('resultsSummary').style.display = 'none';
                return; // Stop the function if not all questions are answered
            }

            // Display total score
            document.getElementById('totalScore').textContent = totalCorrect;

            // Display score per question
            const scorePerQuestionDiv = document.getElementById('scorePerQuestion');
            scorePerQuestionDiv.innerHTML = '<h3>Puntaje por Pregunta:</h3>';
            for (const key in questionResults) {
                const result = questionResults[key];
                const statusClass = result.isCorrect ? 'correct-q' : 'incorrect-q';
                const statusText = result.isCorrect ? 'Correcto' : 'Incorrecto';
                scorePerQuestionDiv.innerHTML += `<div class="${statusClass}"><strong>${result.text}:</strong> ${statusText}</div>`;
            }

            // Show results summary section
            document.getElementById('resultsSummary').style.display = 'block';
        }

        // Function to generate PDF summary
        function generatePdfSummary() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const studentName = document.getElementById('studentName').value;
            const studentSurname = document.getElementById('studentSurname').value;
            const totalScore = document.getElementById('totalScore').textContent;

            if (!studentName || !studentSurname) {
                alert('Por favor, ingresa tu Nombre y Apellido para descargar el resumen.');
                return;
            }

            doc.setFontSize(22);
            doc.text("Resumen de Ejercicios: Direcciones IP", 105, 20, null, null, "center");

            doc.setFontSize(14);
            doc.text(`Nombre: ${studentName} ${studentSurname}`, 20, 40);
            doc.text(`Puntaje Total: ${totalScore} / 14`, 20, 50);

            doc.setFontSize(12);
            let y = 70; // Starting Y position for question results

            doc.text("Puntaje por Pregunta:", 20, y);
            y += 10;

            for (const key in questionResults) {
                const result = questionResults[key];
                const statusText = result.isCorrect ? 'Correcto' : 'Incorrecto';
                doc.text(`- ${result.text}: ${statusText}`, 25, y);
                y += 7;
                if (y > 280) { // Check if new page is needed
                    doc.addPage();
                    y = 20;
                }
            }

            doc.save(`Resumen_Ejercicios_IP_${studentName}_${studentSurname}.pdf`);
        }
    </script>

<h3><a href="Clase 7.html" id="menu">Volver a la Clase 7: Direcciones IP.</a></h3>
</body>
</html>
