<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicios: Conversiones IP (Binario y Decimal)</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #004085;
            font-size: 2.8em;
            margin-bottom: 30px;
            border-bottom: 3px solid #007bff;
            padding-bottom: 15px;
        }
        h2 {
            color: #0056b3;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e7ee;
            padding-bottom: 10px;
        }
        h3 {
            color: #007bff;
            font-size: 1.3em;
            margin-top: 25px;
            margin-bottom: 10px;
        }
        .question-block {
            background-color: #e9f7fe;
            border: 1px solid #cceeff;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .question-block p {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }
        .options label {
            display: block;
            margin-bottom: 8px;
            cursor: pointer;
            padding: 5px 0;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .options label:hover {
            background-color: #e0f2f7;
        }
        .options input[type="radio"],
        .options input[type="checkbox"] {
            margin-right: 10px;
        }
        input[type="text"] {
            width: calc(100% - 22px); /* Adjust for padding and border */
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            background-color: #fcfcfc;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        .ip-octet-inputs {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .ip-octet-inputs input {
            width: calc(25% - 10px);
            text-align: center;
        }
        .feedback {
            margin-top: 10px;
            padding: 8px 12px;
            border-radius: 5px;
            font-weight: 600;
            display: none; /* Hidden by default */
        }
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .button-group {
            text-align: center;
            margin-top: 40px;
        }
        .btn {
            background-color: #007bff;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
        }
        .btn:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }
        .results-summary {
            margin-top: 50px;
            padding: 30px;
            background-color: #f0fdf4;
            border: 2px solid #28a745;
            border-radius: 12px;
            display: none; /* Hidden by default */
        }
        .results-summary h2 {
            color: #28a745;
            border-bottom-color: #28a745;
        }
        .results-summary p {
            font-size: 1.1em;
            margin-bottom: 10px;
        }
        .results-summary input[type="text"] {
            width: calc(50% - 10px);
            padding: 10px;
            margin-right: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
        }
        .results-summary .btn {
            margin-top: 20px;
            width: auto;
            padding: 12px 25px;
            font-size: 1em;
            background-color: #6c757d;
            box-shadow: 0 4px 10px rgba(108, 117, 125, 0.3);
        }
        .results-summary .btn:hover {
            background-color: #5a6268;
        }
        .score-per-question {
            margin-top: 20px;
            border-top: 1px dashed #ccc;
            padding-top: 15px;
        }
        .score-per-question div {
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        .score-per-question .correct-q {
            color: #155724;
            font-weight: 600;
        }
        .score-per-question .incorrect-q {
            color: #721c24;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ejercicios: Conversiones IP (Binario y Decimal)</h1>
        <p style="text-align: center; margin-bottom: 30px;">Practica tus habilidades de conversión entre sistemas numéricos binario y decimal, ¡clave para entender las redes!</p>

        <!-- Sección 1: Binario a Decimal -->
        <h2>1. Conversión de Binario a Decimal</h2>
        <p>Convierte los siguientes números binarios a su equivalente decimal:</p>

        <div class="question-block" id="ex1-q1">
            <h3>Binario: <code>10110010</code></h3>
            <p>Decimal:</p>
            <input type="text" id="ex1-q1-input" placeholder="Ingresa el número decimal">
            <div class="feedback" id="ex1-q1-feedback"></div>
        </div>

        <div class="question-block" id="ex1-q2">
            <h3>Binario: <code>01111111</code></h3>
            <p>Decimal:</p>
            <input type="text" id="ex1-q2-input" placeholder="Ingresa el número decimal">
            <div class="feedback" id="ex1-q2-feedback"></div>
        </div>

        <div class="question-block" id="ex1-q3">
            <h3>Binario: <code>11110000</code></h3>
            <p>Decimal:</p>
            <input type="text" id="ex1-q3-input" placeholder="Ingresa el número decimal">
            <div class="feedback" id="ex1-q3-feedback"></div>
        </div>

        <div class="question-block" id="ex1-q4">
            <h3>Binario: <code>00000001</code></h3>
            <p>Decimal:</p>
            <input type="text" id="ex1-q4-input" placeholder="Ingresa el número decimal">
            <div class="feedback" id="ex1-q4-feedback"></div>
        </div>

        <div class="question-block" id="ex1-q5">
            <h3>Binario: <code>10000000</code></h3>
            <p>Decimal:</p>
            <input type="text" id="ex1-q5-input" placeholder="Ingresa el número decimal">
            <div class="feedback" id="ex1-q5-feedback"></div>
        </div>

        <!-- Sección 2: Decimal a Binario -->
        <h2>2. Conversión de Decimal a Binario</h2>
        <p>Convierte los siguientes números decimales a su equivalente binario (en formato de 8 bits, rellenando con ceros a la izquierda si es necesario):</p>

        <div class="question-block" id="ex2-q1">
            <h3>Decimal: <code>255</code></h3>
            <p>Binario:</p>
            <input type="text" id="ex2-q1-input" placeholder="Ej: 11111111">
            <div class="feedback" id="ex2-q1-feedback"></div>
        </div>

        <div class="question-block" id="ex2-q2">
            <h3>Decimal: <code>67</code></h3>
            <p>Binario:</p>
            <input type="text" id="ex2-q2-input" placeholder="Ej: 01000011">
            <div class="feedback" id="ex2-q2-feedback"></div>
        </div>

        <div class="question-block" id="ex2-q3">
            <h3>Decimal: <code>150</code></h3>
            <p>Binario:</p>
            <input type="text" id="ex2-q3-input" placeholder="Ej: 10010110">
            <div class="feedback" id="ex2-q3-feedback"></div>
        </div>

        <div class="question-block" id="ex2-q4">
            <h3>Decimal: <code>5</code></h3>
            <p>Binario:</p>
            <input type="text" id="ex2-q4-input" placeholder="Ej: 00000101">
            <div class="feedback" id="ex2-q4-feedback"></div>
        </div>

        <div class="question-block" id="ex2-q5">
            <h3>Decimal: <code>200</code></h3>
            <p>Binario:</p>
            <input type="text" id="ex2-q5-input" placeholder="Ej: 11001000">
            <div class="feedback" id="ex2-q5-feedback"></div>
        </div>

        <!-- Sección 3: Construye una IP desde Ceros y Unos -->
        <h2>3. Construye una IP desde Ceros y Unos</h2>
        <p>Convierte las direcciones IP entre binario y decimal.</p>

        <div class="question-block" id="ex3-q1-ip">
            <h3>Convertir IP Binaria a Decimal:</h3>
            <p>IP Binaria: <code>11000000.10101000.00000001.00001011</code></p>
            <p>IP Decimal:</p>
            <div class="ip-octet-inputs">
                <input type="text" id="ex3-q1-o1" placeholder="Octeto 1">
                .
                <input type="text" id="ex3-q1-o2" placeholder="Octeto 2">
                .
                <input type="text" id="ex3-q1-o3" placeholder="Octeto 3">
                .
                <input type="text" id="ex3-q1-o4" placeholder="Octeto 4">
            </div>
            <div class="feedback" id="ex3-q1-feedback"></div>
        </div>

        <div class="question-block" id="ex3-q2-ip">
            <h3>Convertir IP Decimal a Binaria:</h3>
            <p>IP Decimal: <code>172.16.20.1</code></p>
            <p>IP Binaria (8 bits por octeto):</p>
            <div class="ip-octet-inputs">
                <input type="text" id="ex3-q2-o1" placeholder="Octeto 1">
                .
                <input type="text" id="ex3-q2-o2" placeholder="Octeto 2">
                .
                <input type="text" id="ex3-q2-o3" placeholder="Octeto 3">
                .
                <input type="text" id="ex3-q2-o4" placeholder="Octeto 4">
            </div>
            <div class="feedback" id="ex3-q2-feedback"></div>
        </div>

        <div class="button-group">
            <button class="btn" onclick="evaluateAnswers()">EVALUAR RESPUESTAS</button>
        </div>

        <!-- Resumen de Resultados -->
        <div class="results-summary" id="resultsSummary">
            <h2>Resumen de Resultados</h2>
            <p><strong>Puntaje Total:</strong> <span id="totalScore">0</span> / 14</p>
            <div class="score-per-question" id="scorePerQuestion">
                <!-- Scores for each question will be inserted here by JS -->
            </div>
            
            <h3>Generar Resumen en PDF</h3>
            <p>Completa tus datos para descargar el resumen de tus resultados.</p>
            <input type="text" id="studentName" placeholder="Nombre">
            <input type="text" id="studentSurname" placeholder="Apellido">
            <button class="btn" onclick="generatePdfSummary()">Descargar Resumen</button>
        </div>
    </div>

    <!-- jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Define las respuestas correctas
        const correctAnswers = {
            // Sección 1: Binario a Decimal
            "ex1-q1-input": "178", // 10110010
            "ex1-q2-input": "127", // 01111111
            "ex1-q3-input": "240", // 11110000
            "ex1-q4-input": "1",   // 00000001
            "ex1-q5-input": "128", // 10000000

            // Sección 2: Decimal a Binario (8 bits)
            "ex2-q1-input": "11111111", // 255
            "ex2-q2-input": "01000011", // 67
            "ex2-q3-input": "10010110", // 150
            "ex2-q4-input": "00000101", // 5
            "ex2-q5-input": "11001000", // 200

            // Sección 3: Construye una IP
            // IP Binaria a Decimal: 11000000.10101000.00000001.00001011
            "ex3-q1-o1": "192",
            "ex3-q1-o2": "168",
            "ex3-q1-o3": "1",
            "ex3-q1-o4": "11",
            // IP Decimal a Binaria: 172.16.20.1
            "ex3-q2-o1": "10101100", // 172
            "ex3-q2-o2": "00010000", // 16
            "ex3-q2-o3": "00010100", // 20
            "ex3-q2-o4": "00000001"  // 1
        };

        // Almacena los resultados por pregunta para el PDF
        let questionResults = {};
        const totalPossibleScore = 5 + 5 + 4; // 5 bin->dec, 5 dec->bin, 4 for IP bin->dec, 4 for IP dec->bin

        function evaluateAnswers() {
            let totalCorrect = 0;
            questionResults = {}; // Reset results for new evaluation
            let allAnswered = true; // Flag to check if all questions are answered

            // Helper function to evaluate text input questions
            function evaluateTextInput(inputId, correctValue, questionText, parentBlockId) {
                const inputElement = document.getElementById(inputId);
                let userAnswer = inputElement ? inputElement.value.trim() : "";
                let isCorrect = (userAnswer === correctValue);

                if (userAnswer === "") {
                    allAnswered = false;
                }

                const feedbackDiv = document.getElementById(parentBlockId).querySelector('.feedback');
                if (feedbackDiv && allAnswered) { // Only update feedback if allAnswered is still true
                    feedbackDiv.style.display = 'block';
                    if (isCorrect) {
                        feedbackDiv.className = 'feedback correct';
                        feedbackDiv.textContent = '¡Correcto!';
                    } else {
                        feedbackDiv.className = 'feedback incorrect';
                        feedbackDiv.textContent = `Incorrecto. La respuesta correcta era: ${correctValue}`;
                    }
                } else if (!feedbackDiv) {
                    console.error(`Div de feedback para ${parentBlockId} no encontrado.`);
                }
                
                return { isCorrect, userAnswer: userAnswer || 'No respondido', correctAnswer: correctValue, text: questionText };
            }

            // --- Sección 1: Binario a Decimal ---
            for (let i = 1; i <= 5; i++) {
                const inputId = `ex1-q${i}-input`;
                const questionText = `Binario a Decimal: ${document.getElementById(`ex1-q${i}`).querySelector('h3').textContent.replace('Binario: ', '')}`;
                const result = evaluateTextInput(inputId, correctAnswers[inputId], questionText, `ex1-q${i}`);
                if (result.isCorrect) totalCorrect++;
                questionResults[inputId] = result;
            }

            // --- Sección 2: Decimal a Binario ---
            for (let i = 1; i <= 5; i++) {
                const inputId = `ex2-q${i}-input`;
                const questionText = `Decimal a Binario: ${document.getElementById(`ex2-q${i}`).querySelector('h3').textContent.replace('Decimal: ', '')}`;
                const result = evaluateTextInput(inputId, correctAnswers[inputId], questionText, `ex2-q${i}`);
                if (result.isCorrect) totalCorrect++;
                questionResults[inputId] = result;
            }

            // --- Sección 3: Construye una IP desde Ceros y Unos ---
            // Parte 3a: IP Binaria a Decimal
            const ipBinToDecOctets = ["ex3-q1-o1", "ex3-q1-o2", "ex3-q1-o3", "ex3-q1-o4"];
            let ipBinToDecCorrectCount = 0;
            ipBinToDecOctets.forEach((id, index) => {
                const questionText = `IP Binaria a Decimal (Octeto ${index + 1})`;
                const result = evaluateTextInput(id, correctAnswers[id], questionText, `ex3-q1-ip`);
                if (result.isCorrect) ipBinToDecCorrectCount++;
                questionResults[id] = result;
            });
            // Custom feedback for the IP conversion block
            const ex3q1FeedbackDiv = document.getElementById('ex3-q1-ip').querySelector('.feedback');
            if (ex3q1FeedbackDiv && allAnswered) {
                ex3q1FeedbackDiv.style.display = 'block';
                if (ipBinToDecCorrectCount === 4) {
                    ex3q1FeedbackDiv.className = 'feedback correct';
                    ex3q1FeedbackDiv.textContent = '¡Correcto! Todos los octetos convertidos correctamente.';
                    totalCorrect += 4;
                } else {
                    ex3q1FeedbackDiv.className = 'feedback incorrect';
                    ex3q1FeedbackDiv.textContent = `Incorrecto. ${ipBinToDecCorrectCount} de 4 octetos correctos.`;
                }
            } else if (!ex3q1FeedbackDiv) {
                console.error('Div de feedback para ex3-q1-ip no encontrado.');
            }


            // Parte 3b: IP Decimal a Binaria
            const ipDecToBinOctets = ["ex3-q2-o1", "ex3-q2-o2", "ex3-q2-o3", "ex3-q2-o4"];
            let ipDecToBinCorrectCount = 0;
            ipDecToBinOctets.forEach((id, index) => {
                const questionText = `IP Decimal a Binaria (Octeto ${index + 1})`;
                const result = evaluateTextInput(id, correctAnswers[id], questionText, `ex3-q2-ip`);
                if (result.isCorrect) ipDecToBinCorrectCount++;
                questionResults[id] = result;
            });
            // Custom feedback for the IP conversion block
            const ex3q2FeedbackDiv = document.getElementById('ex3-q2-ip').querySelector('.feedback');
            if (ex3q2FeedbackDiv && allAnswered) {
                ex3q2FeedbackDiv.style.display = 'block';
                if (ipDecToBinCorrectCount === 4) {
                    ex3q2FeedbackDiv.className = 'feedback correct';
                    ex3q2FeedbackDiv.textContent = '¡Correcto! Todos los octetos convertidos correctamente.';
                    totalCorrect += 4;
                } else {
                    ex3q2FeedbackDiv.className = 'feedback incorrect';
                    ex3q2FeedbackDiv.textContent = `Incorrecto. ${ipDecToBinCorrectCount} de 4 octetos correctos.`;
                }
            } else if (!ex3q2FeedbackDiv) {
                console.error('Div de feedback para ex3-q2-ip no encontrado.');
            }


            // --- Final check and display results ---
            if (!allAnswered) {
                alert('Por favor, responde todas las preguntas antes de evaluar.');
                // Hide feedback and summary if not all questions are answered
                document.querySelectorAll('.feedback').forEach(div => div.style.display = 'none');
                document.getElementById('resultsSummary').style.display = 'none';
                return; // Stop the function if not all questions are answered
            }

            // Display total score
            document.getElementById('totalScore').textContent = totalCorrect;

            // Display score per question
            const scorePerQuestionDiv = document.getElementById('scorePerQuestion');
            scorePerQuestionDiv.innerHTML = '<h3>Puntaje por Pregunta:</h3>';
            for (const key in questionResults) {
                const result = questionResults[key];
                const statusClass = result.isCorrect ? 'correct-q' : 'incorrect-q';
                const statusText = result.isCorrect ? 'Correcto' : 'Incorrecto';
                scorePerQuestionDiv.innerHTML += `<div class="${statusClass}"><strong>${result.text}:</strong> ${statusText}</div>`;
            }

            // Show results summary section
            document.getElementById('resultsSummary').style.display = 'block';
        }

        // Function to generate PDF summary
        function generatePdfSummary() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const studentName = document.getElementById('studentName').value;
            const studentSurname = document.getElementById('studentSurname').value;
            const totalScore = document.getElementById('totalScore').textContent;

            if (!studentName || !studentSurname) {
                alert('Por favor, ingresa tu Nombre y Apellido para descargar el resumen.');
                return;
            }

            doc.setFontSize(22);
            doc.text("Resumen de Ejercicios: Conversiones IP", 105, 20, null, null, "center");

            doc.setFontSize(14);
            doc.text(`Nombre: ${studentName} ${studentSurname}`, 20, 40);
            doc.text(`Puntaje Total: ${totalScore} / ${totalPossibleScore}`, 20, 50);

            doc.setFontSize(12);
            let y = 70; // Starting Y position for question results

            doc.text("Puntaje por Pregunta:", 20, y);
            y += 10;

            for (const key in questionResults) {
                const result = questionResults[key];
                const statusText = result.isCorrect ? 'Correcto' : 'Incorrecto';
                doc.text(`- ${result.text}: ${statusText}`, 25, y);
                y += 7;
                if (y > 280) { // Check if new page is needed
                    doc.addPage();
                    y = 20;
                }
            }

            doc.save(`Resumen_Ejercicios_Conversiones_IP_${studentName}_${studentSurname}.pdf`);
        }
    </script>
<h3><a href="Clase 8.html" id="menu">Volver a la Clase 8: Conversiones IP.</a></h3>
</body>
</html>
